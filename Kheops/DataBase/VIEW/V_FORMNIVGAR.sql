CREATE OR REPLACE VIEW ZALBINKHEO.V_FORMNIVGAR ( 
	KARKAQID , 
	LIBMODELE , 
	GUIDM , 
	CODENIV1 , 
	CODEGARNIV1 FOR COLUMN CODEG00001 , 
	DESCRNIV1 , 
	CARACNIV1 , 
	NATURENIV1 , 
	CODEPARENTNIV1 FOR COLUMN CODEP00001 , 
	CODENIV1NIV1 FOR COLUMN CODEN00001 , 
	NIVEAUNIV1 , 
	TRINIV1 , 
	DEFGARANTIENIV1 FOR COLUMN DEFGA00001 , 
	CATNATNIV1 , 
	INDEXEENIV1 FOR COLUMN INDEX00001 , 
	CODETAXENIV1 FOR COLUMN CODET00001 , 
	ASSIETTEVALEURNIV1 FOR COLUMN ASSIE00001 , 
	ASSIETTEUNITENIV1 FOR COLUMN ASSIE00002 , 
	ASSIETTEBASENIV1 FOR COLUMN ASSIE00003 , 
	ASSIETTEMODIFIABLENIV1 FOR COLUMN ASSIE00004 , 
	TYPECONTROLEDATENIV1 FOR COLUMN TYPEC00001 , 
	MONTANTREFNIV1 FOR COLUMN MONTA00001 , 
	ASSOBLIGATOIRENIV1 FOR COLUMN ASSOB00001 , 
	PARAMNATMODNIV1 FOR COLUMN PARAM00001 , 
	MODEALIMNIV1 FOR COLUMN MODEA00001 , 
	INVENPOSSIBLE1 FOR COLUMN INVEN00001 , 
	CODENIV2 , 
	CODEGARNIV2 FOR COLUMN CODEG00002 , 
	DESCRNIV2 , 
	CARACNIV2 , 
	NATURENIV2 , 
	CODEPARENTNIV2 FOR COLUMN CODEP00002 , 
	CODENIV1NIV2 FOR COLUMN CODEN00002 , 
	NIVEAUNIV2 , 
	TRINIV2 , 
	DEFGARANTIENIV2 FOR COLUMN DEFGA00002 , 
	CATNATNIV2 , 
	INDEXEENIV2 FOR COLUMN INDEX00002 , 
	CODETAXENIV2 FOR COLUMN CODET00002 , 
	ASSIETTEVALEURNIV2 FOR COLUMN ASSIE00005 , 
	ASSIETTEUNITENIV2 FOR COLUMN ASSIE00006 , 
	ASSIETTEBASENIV2 FOR COLUMN ASSIE00007 , 
	ASSIETTEMODIFIABLENIV2 FOR COLUMN ASSIE00008 , 
	TYPECONTROLEDATENIV2 FOR COLUMN TYPEC00002 , 
	MONTANTREFNIV2 FOR COLUMN MONTA00002 , 
	ASSOBLIGATOIRENIV2 FOR COLUMN ASSOB00002 , 
	PARAMNATMODNIV2 FOR COLUMN PARAM00002 , 
	MODEALIMNIV2 FOR COLUMN MODEA00002 , 
	INVENPOSSIBLE2 FOR COLUMN INVEN00002 , 
	CODENIV3 , 
	CODEGARNIV3 FOR COLUMN CODEG00003 , 
	DESCRNIV3 , 
	CARACNIV3 , 
	NATURENIV3 , 
	CODEPARENTNIV3 FOR COLUMN CODEP00003 , 
	CODENIV1NIV3 FOR COLUMN CODEN00003 , 
	NIVEAUNIV3 , 
	TRINIV3 , 
	DEFGARANTIENIV3 FOR COLUMN DEFGA00003 , 
	CATNATNIV3 , 
	INDEXEENIV3 FOR COLUMN INDEX00003 , 
	CODETAXENIV3 FOR COLUMN CODET00003 , 
	ASSIETTEVALEURNIV3 FOR COLUMN ASSIE00009 , 
	ASSIETTEUNITENIV3 FOR COLUMN ASSIE00010 , 
	ASSIETTEBASENIV3 FOR COLUMN ASSIE00011 , 
	ASSIETTEMODIFIABLENIV3 FOR COLUMN ASSIE00012 , 
	TYPECONTROLEDATENIV3 FOR COLUMN TYPEC00003 , 
	MONTANTREFNIV3 FOR COLUMN MONTA00003 , 
	ASSOBLIGATOIRENIV3 FOR COLUMN ASSOB00003 , 
	PARAMNATMODNIV3 FOR COLUMN PARAM00003 , 
	MODEALIMNIV3 FOR COLUMN MODEA00003 , 
	INVENPOSSIBLE3 FOR COLUMN INVEN00003 , 
	CODENIV4 , 
	CODEGARNIV4 FOR COLUMN CODEG00004 , 
	DESCRNIV4 , 
	CARACNIV4 , 
	NATURENIV4 , 
	CODEPARENTNIV4 FOR COLUMN CODEP00004 , 
	CODENIV1NIV4 FOR COLUMN CODEN00004 , 
	NIVEAUNIV4 , 
	TRINIV4 , 
	DEFGARANTIENIV4 FOR COLUMN DEFGA00004 , 
	CATNATNIV4 , 
	INDEXEENIV4 FOR COLUMN INDEX00004 , 
	CODETAXENIV4 FOR COLUMN CODET00004 , 
	ASSIETTEVALEURNIV4 FOR COLUMN ASSIE00013 , 
	ASSIETTEUNITENIV4 FOR COLUMN ASSIE00014 , 
	ASSIETTEBASENIV4 FOR COLUMN ASSIE00015 , 
	ASSIETTEMODIFIABLENIV4 FOR COLUMN ASSIE00016 , 
	TYPECONTROLEDATENIV4 FOR COLUMN TYPEC00004 , 
	MONTANTREFNIV4 FOR COLUMN MONTA00004 , 
	ASSOBLIGATOIRENIV4 FOR COLUMN ASSOB00004 , 
	PARAMNATMODNIV4 FOR COLUMN PARAM00004 , 
	MODEALIMNIV4 FOR COLUMN MODEA00004 , 
	INVENPOSSIBLE4 FOR COLUMN INVEN00004 ) 
	AS 
	(SELECT NIV1.KARKAQID KARKAQID, NIV1.KARMODELE LIBMODELE , NIV1.KARID GUIDM ,  
									GAR1.C2SEQ CODENIV1 , GAR1.C2GAR CODEGARNIV1 , GARAN1.GADES DESCRNIV1 , GAR1.C2CAR CARACNIV1 , GAR1.C2NAT NATURENIV1 , GAR1.C2SEM CODEPARENTNIV1 , GAR1.C2SE1 CODENIV1NIV1 , GAR1.C2NIV NIVEAUNIV1 , GAR1.C2TRI TRINIV1 , IFNULL ( GARAN1.GADFG , '' ) DEFGARANTIENIV1 , GAR1.C2CNA CATNATNIV1 , GAR1.C2INA INDEXEENIV1 , GAR1.C2TAX CODETAXENIV1 , GAL1.C4VAL ASSIETTEVALEURNIV1 , CASE GAL1.C4UNT WHEN 'UM' THEN 'D' ELSE GAL1.C4UNT END ASSIETTEUNITENIV1 , GAL1.C4BAS ASSIETTEBASENIV1 , GAL1.C4MAJ ASSIETTEMODIFIABLENIV1 , GAR1.C2TCD TYPECONTROLEDATENIV1 , GAR1.C2MRF MONTANTREFNIV1 , GAL1.C4OBL ASSOBLIGATOIRENIV1 , GAR1.C2NTM PARAMNATMODNIV1 , GAL1.C4ALA MODEALIMNIV1 , IFNULL ( GARAN1.GAINV , '' ) INVENPOSSIBLE1 ,  
									GAR2.C2SEQ CODENIV2 , GAR2.C2GAR CODEGARNIV2 , GARAN2.GADES DESCRNIV2 , GAR2.C2CAR CARACNIV2 , GAR2.C2NAT NATURENIV2 , GAR2.C2SEM CODEPARENTNIV2 , GAR2.C2SE1 CODENIV1NIV2 , GAR2.C2NIV NIVEAUNIV2 , GAR2.C2TRI TRINIV2 , IFNULL ( GARAN2.GADFG , '' ) DEFGARANTIENIV2 , GAR2.C2CNA CATNATNIV2 , GAR2.C2INA INDEXEENIV2 , GAR2.C2TAX CODETAXENIV2 , GAL2.C4VAL ASSIETTEVALEURNIV2 , CASE GAL2.C4UNT WHEN 'UM' THEN 'D' ELSE GAL2.C4UNT END ASSIETTEUNITENIV2 , GAL2.C4BAS ASSIETTEBASENIV2 , GAL2.C4MAJ ASSIETTEMODIFIABLENIV2 , GAR2.C2TCD TYPECONTROLEDATENIV2 , GAR2.C2MRF MONTANTREFNIV2 , GAL2.C4OBL ASSOBLIGATOIRENIV2 , GAR2.C2NTM PARAMNATMODNIV2 , GAL2.C4ALA MODEALIMNIV2 , IFNULL ( GARAN2.GAINV , '' ) INVENPOSSIBLE2 ,  
									GAR3.C2SEQ CODENIV3 , GAR3.C2GAR CODEGARNIV3 , GARAN3.GADES DESCRNIV3 , GAR3.C2CAR CARACNIV3 , GAR3.C2NAT NATURENIV3 , GAR3.C2SEM CODEPARENTNIV3 , GAR3.C2SE1 CODENIV1NIV3 , GAR3.C2NIV NIVEAUNIV3 , GAR3.C2TRI TRINIV3 , IFNULL ( GARAN3.GADFG , '' ) DEFGARANTIENIV3 , GAR3.C2CNA CATNATNIV3 , GAR3.C2INA INDEXEENIV3 , GAR3.C2TAX CODETAXENIV3 , GAL3.C4VAL ASSIETTEVALEURNIV3 , CASE GAL3.C4UNT WHEN 'UM' THEN 'D' ELSE GAL3.C4UNT END ASSIETTEUNITENIV3 , GAL3.C4BAS ASSIETTEBASENIV3 , GAL3.C4MAJ ASSIETTEMODIFIABLENIV3 , GAR3.C2TCD TYPECONTROLEDATENIV3 , GAR3.C2MRF MONTANTREFNIV3 , GAL3.C4OBL ASSOBLIGATOIRENIV3 , GAR3.C2NTM PARAMNATMODNIV3 , GAL3.C4ALA MODEALIMNIV3 , IFNULL ( GARAN3.GAINV , '' ) INVENPOSSIBLE3 ,  
									GAR4.C2SEQ CODENIV4 , GAR4.C2GAR CODEGARNIV4 , GARAN4.GADES DESCRNIV4 , GAR4.C2CAR CARACNIV4 , GAR4.C2NAT NATURENIV4 , GAR4.C2SEM CODEPARENTNIV4 , GAR4.C2SE1 CODENIV1NIV4 , GAR4.C2NIV NIVEAUNIV4 , GAR4.C2TRI TRINIV4 , IFNULL ( GARAN4.GADFG , '' ) DEFGARANTIENIV4 , GAR4.C2CNA CATNATNIV4 , GAR4.C2INA INDEXEENIV4 , GAR4.C2TAX CODETAXENIV4 , GAL4.C4VAL ASSIETTEVALEURNIV4 , CASE GAL4.C4UNT WHEN 'UM' THEN 'D' ELSE GAL4.C4UNT END ASSIETTEUNITENIV4 , GAL4.C4BAS ASSIETTEBASENIV4 , GAL4.C4MAJ ASSIETTEMODIFIABLENIV4 , GAR4.C2TCD TYPECONTROLEDATENIV4 , GAR4.C2MRF MONTANTREFNIV4 , GAL4.C4OBL ASSOBLIGATOIRENIV4 , GAR4.C2NTM PARAMNATMODNIV4 , GAL4.C4ALA MODEALIMNIV4 , IFNULL ( GARAN4.GAINV , '' ) INVENPOSSIBLE4  
								  
								FROM ZALBINKHEO.KCATMODELE NIV1  
									LEFT JOIN ZALBINKMOD.YPLTGAR GAR1 ON NIV1.KARMODELE = GAR1.C2MGA AND GAR1.C2CAR IN ( 'A' , 'F' , 'B' , 'O' , 'P' , 'S' ) AND GAR1.C2NIV = 1 AND GAR1.C2SEM = 0  
									LEFT JOIN ZALBINKHEO.KGARAN GARAN1 ON GAR1.C2GAR = GARAN1.GAGAR  
									LEFT JOIN ZALBINKMOD.YPLTGAL GAL1 ON GAR1.C2SEQ = GAL1.C4SEQ AND GAL1.C4TYP = 0  
									  
									LEFT JOIN ZALBINKHEO.KCATMODELE NIV2 ON NIV2.KARID = NIV1.KARID  
									LEFT JOIN ZALBINKMOD.YPLTGAR GAR2 ON NIV2.KARMODELE = GAR2.C2MGA AND GAR2.C2CAR IN ( 'A' , 'F' , 'B' , 'O' , 'P' , 'S' ) AND GAR2.C2NIV = 2 AND GAR2.C2SEM = GAR1.C2SEQ  
									LEFT JOIN ZALBINKHEO.KGARAN GARAN2 ON GAR2.C2GAR = GARAN2.GAGAR  
									LEFT JOIN ZALBINKMOD.YPLTGAL GAL2 ON GAR2.C2SEQ = GAL2.C4SEQ AND GAL2.C4TYP = 0  
									  
									LEFT JOIN ZALBINKHEO.KCATMODELE NIV3 ON NIV3.KARID = NIV2.KARID  
									LEFT JOIN ZALBINKMOD.YPLTGAR GAR3 ON NIV3.KARMODELE = GAR3.C2MGA AND GAR3.C2CAR IN ( 'A' , 'F' , 'B' , 'O' , 'P' , 'S' ) AND GAR3.C2NIV = 3 AND GAR3.C2SEM = GAR2.C2SEQ  
									LEFT JOIN ZALBINKHEO.KGARAN GARAN3 ON GAR3.C2GAR = GARAN3.GAGAR  
									LEFT JOIN ZALBINKMOD.YPLTGAL GAL3 ON GAR3.C2SEQ = GAL3.C4SEQ AND GAL3.C4TYP = 0  
									  
									LEFT JOIN ZALBINKHEO.KCATMODELE NIV4 ON NIV4.KARID = NIV3.KARID  
									LEFT JOIN ZALBINKMOD.YPLTGAR GAR4 ON NIV4.KARMODELE = GAR4.C2MGA AND GAR4.C2CAR IN ( 'A' , 'F' , 'B' , 'O' , 'P' , 'S' ) AND GAR4.C2NIV = 4 AND GAR4.C2SEM = GAR3.C2SEQ  
									LEFT JOIN ZALBINKHEO.KGARAN GARAN4 ON GAR4.C2GAR = GARAN4.GAGAR  
									LEFT JOIN ZALBINKMOD.YPLTGAL GAL4 ON GAR4.C2SEQ = GAL4.C4SEQ AND GAL4.C4TYP = 0) ; 
  
LABEL ON COLUMN ZALBINKHEO.V_FORMNIVGAR 
( DESCRNIV1 IS 'Désignation garantie' , 
	ASSIETTEBASENIV1 IS 'Base' , 
	ASSIETTEMODIFIABLENIV1 IS 'Modifiable' , 
	ASSOBLIGATOIRENIV1 IS 'Obli' , 
	DESCRNIV2 IS 'Désignation garantie' , 
	ASSIETTEBASENIV2 IS 'Base' , 
	ASSIETTEMODIFIABLENIV2 IS 'Modifiable' , 
	ASSOBLIGATOIRENIV2 IS 'Obli' , 
	DESCRNIV3 IS 'Désignation garantie' , 
	ASSIETTEBASENIV3 IS 'Base' , 
	ASSIETTEMODIFIABLENIV3 IS 'Modifiable' , 
	ASSOBLIGATOIRENIV3 IS 'Obli' , 
	DESCRNIV4 IS 'Désignation garantie' , 
	ASSIETTEBASENIV4 IS 'Base' , 
	ASSIETTEMODIFIABLENIV4 IS 'Modifiable' , 
	ASSOBLIGATOIRENIV4 IS 'Obli' ) ; 
  
LABEL ON COLUMN ZALBINKHEO.V_FORMNIVGAR 
( DESCRNIV1 TEXT IS 'Désignation garantie' , 
	ASSIETTEVALEURNIV1 TEXT IS 'Valeur' , 
	ASSIETTEBASENIV1 TEXT IS 'Base' , 
	ASSIETTEMODIFIABLENIV1 TEXT IS 'Modifiable' , 
	ASSOBLIGATOIRENIV1 TEXT IS 'Obligatoire' , 
	DESCRNIV2 TEXT IS 'Désignation garantie' , 
	ASSIETTEVALEURNIV2 TEXT IS 'Valeur' , 
	ASSIETTEBASENIV2 TEXT IS 'Base' , 
	ASSIETTEMODIFIABLENIV2 TEXT IS 'Modifiable' , 
	ASSOBLIGATOIRENIV2 TEXT IS 'Obligatoire' , 
	DESCRNIV3 TEXT IS 'Désignation garantie' , 
	ASSIETTEVALEURNIV3 TEXT IS 'Valeur' , 
	ASSIETTEBASENIV3 TEXT IS 'Base' , 
	ASSIETTEMODIFIABLENIV3 TEXT IS 'Modifiable' , 
	ASSOBLIGATOIRENIV3 TEXT IS 'Obligatoire' , 
	DESCRNIV4 TEXT IS 'Désignation garantie' , 
	ASSIETTEVALEURNIV4 TEXT IS 'Valeur' , 
	ASSIETTEBASENIV4 TEXT IS 'Base' , 
	ASSIETTEMODIFIABLENIV4 TEXT IS 'Modifiable' , 
	ASSOBLIGATOIRENIV4 TEXT IS 'Obligatoire' ) ; 
  
