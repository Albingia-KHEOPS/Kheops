CREATE OR REPLACE VIEW ZALBINKHEO.V_LISTCLAUSESTD ( 
	ISCLAUSELIBRE FOR COLUMN ISCLA00001 , 
	ID , 
	CODEOFRRE , 
	TYP , 
	CODEOPT , 
	VERSIONOFFRE FOR COLUMN VERSI00001 , 
	CODERISQUE , 
	DESCRISQUE , 
	CODEOBJET , 
	DESCOBJET , 
	CODEFORMULE FOR COLUMN CODEF00001 , 
	DESCFORMULE FOR COLUMN DESCF00001 , 
	LETTREFORMULE FOR COLUMN LETTR00001 , 
	RUBRIQUE , 
	SOUSRUBRIQUE FOR COLUMN SOUSR00001 , 
	SEQUEN , 
	LEDES , 
	NUMEROVERSION FOR COLUMN NUMER00001 , 
	COLUMNDATEEFFETVERSIONDEBUT FOR COLUMN COLUM00001 , 
	COLUMNDATEEFFETVERSIONFIN FOR COLUMN COLUM00002 , 
	ORIGINE , 
	ETAPE , 
	CONTEXTE , 
	CODESITUATION FOR COLUMN CODES00001 , 
	DATESITUATION FOR COLUMN DATES00001 , 
	NUMEROAVENANTCREATION FOR COLUMN NUMER00002 , 
	DATEAVENANTCREATION FOR COLUMN DATEA00001 , 
	NUMEROAVENANTMODIFICATION FOR COLUMN NUMER00003 , 
	DATEAVENANTMODIFICATION FOR COLUMN DATEA00002 , 
	DOCUMENT , 
	CHAPITRE , 
	SOUSCHAPITRE FOR COLUMN SOUSC00001 , 
	NUMEROIMPRESSION FOR COLUMN NUMER00004 , 
	NUMEROORDRE FOR COLUMN NUMER00005 , 
	IMPRESSIONANNEXE FOR COLUMN IMPRE00001 , 
	CODEANNEXE , 
	ACTIONENCHAINE FOR COLUMN ACTIO00001 , 
	ETATTITRE , 
	ATTRIBUTVERSION FOR COLUMN ATTRI00001 , 
	TEXTECLAUSELIBRE FOR COLUMN TEXTE00001 , 
	CODEGARANTIE FOR COLUMN CODEG00001 , 
	LIBELLEGARANTIE FOR COLUMN LIBEL00001 , 
	CLAUSEID , 
	DOCAJOUTE , 
	DOCLIB , 
	ISMODIFSTR , 
	CHEMINFICHIER FOR COLUMN CHEMI00001 , 
	DATEDETAILAVNCREATION FOR COLUMN DATED00001 , 
	ORIGINEFILTRE FOR COLUMN ORIGI00001 ) 
	AS 
	(  
										 SELECT  
															 CASE TBLCLAUSE.KCAXTL WHEN 'O' THEN 1 ELSE 0 END AS ISCLAUSELIBRE,	  
															 TBLCLAUSE.KCAID ID,  
															 TBLCLAUSE.KCAIPB CODEOFRRE,  
															 TBLCLAUSE.KCATYP TYP,  
															 TBLCLAUSE.KCAOPT CODEOPT,  
															 TBLCLAUSE.KCAALX VERSIONOFFRE ,  
														 TBLCLAUSE.KCARSQ CODERISQUE,KABDESC DESCRISQUE,  
															 TBLCLAUSE.KCAOBJ CODEOBJET,KACDESC DESCOBJET,  
															 TBLCLAUSE.KCAFOR CODEFORMULE,KDADESC DESCFORMULE,KDAALPHA LETTREFORMULE,  
															 TBLCLAUSE.KCACLNM1 RUBRIQUE,  
														 TBLCLAUSE.KCACLNM2 SOUSRUBRIQUE,  
														 TBLCLAUSE.KCACLNM3 SEQUEN,  
															 IFNULL(KDULIB, KEQNOM) LEDES,  
															 TBLCLAUSE.KCAVER NUMEROVERSION,  
															 KDUDATD COLUMNDATEEFFETVERSIONDEBUT,	  
															 KDUDATF COLUMNDATEEFFETVERSIONFIN,  
															  --(CASE TBLCLAUSE.KCAAJT WHEN 'O' THEN 'Utilisateur' ELSE 'Système' END  )  )AS ORIGINE,  
															 (CASE TBLCLAUSE.KCATYPD WHEN 'E' THEN 'PJ' ELSE  
															 CASE TBLCLAUSE.KCAAJT WHEN 'O' THEN 'Utilisateur' ELSE 'Système'  
									 END	  
															 END )AS ORIGINE, 					  
															  
															 TBLCLAUSE.KCAETAFF ETAPE,  
															 TBLCLAUSE.KCACTX CONTEXTE,  
															 TBLCLAUSE.KCASIT CODESITUATION,  
															 TBLCLAUSE.KCASITD DATESITUATION,  
															 TBLCLAUSE.KCAAVNC NUMEROAVENANTCREATION,  
															 TBLCLAUSE.KCACRD DATEAVENANTCREATION,  
															 TBLCLAUSE.KCAAVNM NUMEROAVENANTMODIFICATION,  
															 TBLCLAUSE.KCAMAJD DATEAVENANTMODIFICATION,  
															 TBLCLAUSE.KCADOC DOCUMENT,  
															 TBLCLAUSE.KCACHI CHAPITRE,  
															 TBLCLAUSE.KCACHIS SOUSCHAPITRE,  
															 TBLCLAUSE.KCAIMP NUMEROIMPRESSION,  
															 TBLCLAUSE.KCACXI NUMEROORDRE,  
															 TBLCLAUSE.KCAIAN IMPRESSIONANNEXE,  
															 TBLCLAUSE.KCAIAC CODEANNEXE,  
															 TBLCLAUSE.KCATAE ACTIONENCHAINE,  
															 TBLCLAUSE.KCANTA ETATTITRE,  
															 TBLCLAUSE.KCAAIM ATTRIBUTVERSION,  
															 '' TEXTECLAUSELIBRE,  
														 TBLCLAUSE.KCAGAR CODEGARANTIE,GADEA LIBELLEGARANTIE,  
														 TBLCLAUSE.KCAKDUID CLAUSEID, TBLCLAUSE.KCATYPD DOCAJOUTE, IFNULL(KERLIB, IFNULL(KDULIB, KEQNOM)) DOCLIB,  
														 TBLCLAUSE.KCAXTLM ISMODIFSTR,  
														CASE WHEN KEQCHM IS NOT NULL THEN KEQCHM  
															WHEN KERCHM IS NOT NULL THEN KERCHM  
															ELSE ''  
															END CHEMINFICHIER,  
														CASE WHEN TBLCLAUSE.KCANTA = 'O' THEN (HISTOBASE.PBMJA * 10000 + HISTOBASE.PBMJM * 100 + HISTOBASE.PBMJJ )  
															WHEN TBLCLAUSE.KCANTA = 'P' AND TBLCLAUSE.KCASIT = 'V' AND TBLCLAUSE.KCATYPD != 'E' THEN (HISTOBASE.PBMJA * 10000 + HISTOBASE.PBMJM * 100 + HISTOBASE.PBMJJ)  
															WHEN TBLCLAUSE.KCANTA = 'P' AND TBLCLAUSE.KCASIT = 'V' AND TBLCLAUSE.KCATYPD = 'E' THEN TBLCLAUSE.KCASITD  
															WHEN TBLCLAUSE.KCANTA = 'S' AND TBLCLAUSE.KCASIT = 'V' THEN TBLCLAUSE.KCASITD  
															WHEN TBLCLAUSE.KCAAJT = 'O' AND TBLCLAUSE.KCASIT = 'V' THEN TBLCLAUSE.KCASITD  
															ELSE 0  
														 END  DATEDETAILAVNCREATION,  
														 TBLCLAUSE.KCAAJT ORIGINEFILTRE	  
														  --HISTOCLAUSE.KCASIT CODESITUATIONHISTO,  
														  --HISTOCLAUSE.KCAAVNM NUMAVENANTHISTO  
														 FROM  
														 ZALBINKHEO.KPCLAUSE TBLCLAUSE  
														 LEFT JOIN ZALBINKHEO.KCLAUSE KCLAUSE ON TBLCLAUSE.KCACLNM1 = KCLAUSE.KDUNM1 AND TBLCLAUSE.KCACLNM2 = KCLAUSE.KDUNM2 AND TBLCLAUSE.KCACLNM3 = KCLAUSE.KDUNM3 AND TBLCLAUSE.KCAKDUID=KCLAUSE.KDUID  
														 LEFT JOIN ZALBINKHEO.KPDOC ON TBLCLAUSE.KCATXL = KEQID AND TBLCLAUSE.KCATYPD <> 'E'  
														 LEFT JOIN ZALBINKHEO.KPRSQ ON KABRSQ=TBLCLAUSE.KCARSQ AND KABIPB=TBLCLAUSE.KCAIPB AND KABALX=TBLCLAUSE.KCAALX AND KABTYP=TBLCLAUSE.KCATYP  --{13} hist 
														 LEFT JOIN ZALBINKHEO.KPFOR ON KDAFOR=TBLCLAUSE.KCAFOR AND KDAIPB=TBLCLAUSE.KCAIPB AND KDAALX=TBLCLAUSE.KCAALX AND KDATYP=TBLCLAUSE.KCATYP  --{14}hist 
														 LEFT JOIN ZALBINKHEO.KPOBJ ON KACOBJ=TBLCLAUSE.KCAOBJ AND KACIPB=TBLCLAUSE.KCAIPB AND KACALX=TBLCLAUSE.KCAALX AND KACTYP=TBLCLAUSE.KCATYP AND KACRSQ = KABRSQ  --{15}hist 
														 LEFT JOIN ZALBINKHEO.KGARAN ON GAGAR =TBLCLAUSE.KCAGAR  
														 LEFT JOIN ZALBINKHEO.KPDOCEXT ON TBLCLAUSE.KCATXL = KERID AND TBLCLAUSE.KCATYPD = 'E'  
														 LEFT JOIN ZALBINKHEO.YHPBASE HISTOBASE ON PBIPB = TBLCLAUSE.KCAIPB AND PBALX = TBLCLAUSE.KCAALX AND PBTYP = TBLCLAUSE.KCATYP AND PBAVN = TBLCLAUSE.KCAAVNC  
														  
														  
											) ; 
  
LABEL ON COLUMN ZALBINKHEO.V_LISTCLAUSESTD 
( ID IS 'ID unique' , 
	CODEOFRRE IS 'IPB' , 
	TYP IS 'TYP O/P' , 
	CODEOPT IS 'Option' , 
	VERSIONOFFRE IS 'ALX' , 
	CODERISQUE IS 'Risque' , 
	DESCRISQUE IS 'Description' , 
	CODEOBJET IS 'Objet' , 
	DESCOBJET IS 'Description' , 
	CODEFORMULE IS 'Formule' , 
	DESCFORMULE IS 'Description' , 
	LETTREFORMULE IS 'Code Alpha' , 
	RUBRIQUE IS 'Code clause Nm1' , 
	SOUSRUBRIQUE IS 'Code Clause Nm2' , 
	SEQUEN IS 'Code Clause Nm3' , 
	NUMEROVERSION IS 'N° version' , 
	COLUMNDATEEFFETVERSIONDEBUT IS 'Date Validité début' , 
	COLUMNDATEEFFETVERSIONFIN IS 'Date Validité Fin' , 
	ETAPE IS 'Etape d''affichage' , 
	CONTEXTE IS 'Contexte' , 
	CODESITUATION IS 'Code situation' , 
	DATESITUATION IS 'Situation Date' , 
	NUMEROAVENANTCREATION IS 'Avenantde création' , 
	DATEAVENANTCREATION IS 'Création date' , 
	NUMEROAVENANTMODIFICATION IS 'Avenant de modif' , 
	DATEAVENANTMODIFICATION IS 'MAj Date' , 
	DOCUMENT IS 'Document impression' , 
	CHAPITRE IS 'Chapitre impression' , 
	SOUSCHAPITRE IS 'Sous chapitre impres' , 
	NUMEROIMPRESSION IS 'N° Impression' , 
	NUMEROORDRE IS 'N° Ordonnancement' , 
	IMPRESSIONANNEXE IS 'Impress annexe O/N' , 
	CODEANNEXE IS 'Code annexe' , 
	ACTIONENCHAINE IS 'Action Enchainée' , 
	ETATTITRE IS 'Nature de la clause' , 
	ATTRIBUTVERSION IS 'Attribut impression' , 
	CODEGARANTIE IS 'Garantie' , 
	LIBELLEGARANTIE IS 'Abrégé garantie' , 
	CLAUSEID IS 'Clause lien KCLAUSE' , 
	DOCAJOUTE IS 'Doc Ajouté/Génée/Ext' , 
	ISMODIFSTR IS 'Texte libre modifié' , 
	ORIGINEFILTRE IS 'Ajoutée O/N' ) ; 
  
LABEL ON COLUMN ZALBINKHEO.V_LISTCLAUSESTD 
( ID TEXT IS 'ID unique' , 
	CODEOFRRE TEXT IS 'IPB' , 
	TYP TEXT IS 'TYP O/P' , 
	CODEOPT TEXT IS 'Option' , 
	VERSIONOFFRE TEXT IS 'ALX' , 
	CODERISQUE TEXT IS 'Risque' , 
	DESCRISQUE TEXT IS 'Description' , 
	CODEOBJET TEXT IS 'Objet' , 
	DESCOBJET TEXT IS 'Description' , 
	CODEFORMULE TEXT IS 'Formule' , 
	DESCFORMULE TEXT IS 'Description' , 
	LETTREFORMULE TEXT IS 'Code alpha' , 
	RUBRIQUE TEXT IS 'Code clause Nm1' , 
	SOUSRUBRIQUE TEXT IS 'Code clause Nm2' , 
	SEQUEN TEXT IS 'Code Clause Nm3' , 
	NUMEROVERSION TEXT IS 'N° Version' , 
	COLUMNDATEEFFETVERSIONDEBUT TEXT IS 'Date validité Début' , 
	COLUMNDATEEFFETVERSIONFIN TEXT IS 'Date Validité Fin' , 
	ETAPE TEXT IS 'Etape d''affichage' , 
	CONTEXTE TEXT IS 'Contexte' , 
	CODESITUATION TEXT IS 'Code situation' , 
	DATESITUATION TEXT IS 'Situation Date' , 
	NUMEROAVENANTCREATION TEXT IS 'Avenant de création' , 
	DATEAVENANTCREATION TEXT IS 'Création date' , 
	NUMEROAVENANTMODIFICATION TEXT IS 'Avenant de modification' , 
	DATEAVENANTMODIFICATION TEXT IS 'Maj Date' , 
	DOCUMENT TEXT IS 'Document Impression CP CG CS...' , 
	CHAPITRE TEXT IS 'Chapitre impression' , 
	SOUSCHAPITRE TEXT IS 'Sous chapitre impression' , 
	NUMEROIMPRESSION TEXT IS 'N° Impression' , 
	NUMEROORDRE TEXT IS 'N° ordonnancement' , 
	IMPRESSIONANNEXE TEXT IS 'Impression en annexe O/N' , 
	CODEANNEXE TEXT IS 'Code annexe' , 
	ACTIONENCHAINE TEXT IS 'Action enchainée' , 
	ETATTITRE TEXT IS 'Nature de la clause' , 
	ATTRIBUTVERSION TEXT IS 'Attribut d''impression Gras souligné' , 
	CODEGARANTIE TEXT IS 'Garantie' , 
	LIBELLEGARANTIE TEXT IS 'Abrégé garantie' , 
	CLAUSEID TEXT IS 'Clause lien KCLAUSE' , 
	DOCAJOUTE TEXT IS 'Doc Ajouté/Généré/Externe' , 
	ISMODIFSTR TEXT IS 'Texte libre modifié  O/N' , 
	ORIGINEFILTRE TEXT IS 'Ajoutée O/N' ) ; 
  
